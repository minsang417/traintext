<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë¬¸ë‹¨ ì•”ê¸° í”„ë¡œê·¸ë¨ (PWA ì›¹ ë²„ì „)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
    textarea { width: 100%; height: 150px; }
    button { margin: 5px 0; padding: 8px 12px; }
    .blank { display: inline-block; border-bottom: 2px solid black; width: 60px; margin: 0 3px; text-align: center; }
    .sentence { margin: 5px 0; }
  </style>
</head>
<body>
  <h1>ğŸ“– ë¬¸ë‹¨ ì•”ê¸° í”„ë¡œê·¸ë¨</h1>

  <h2>1. ë¬¸ë‹¨ ë“±ë¡</h2>
  <textarea id="paragraphInput" placeholder="ì—¬ê¸°ì— ë¬¸ë‹¨ì„ ì…ë ¥í•˜ì„¸ìš” (ë¬¸ì¥ë§ˆë‹¤ ì¤„ë°”ê¿ˆ)"></textarea>
  <button onclick="registerParagraph()">ë¬¸ë‹¨ ë“±ë¡</button>

  <h2>2. ë“±ë¡ëœ ë¬¸ë‹¨ ì„ íƒ</h2>
  <select id="paragraphSelect"></select>

  <h2>3. ê¸°ëŠ¥ ì„ íƒ</h2>
  <button onclick="startBlankMode()">ë¹ˆì¹¸ ì•”ê¸°</button>
  <button onclick="startOrderMode()">ìˆœì„œ ì•”ê¸°</button>

  <div id="quizArea"></div>

<script>
let paragraphs = [];

function registerParagraph() {
  const text = document.getElementById("paragraphInput").value.trim();
  if (!text) return alert("ë¬¸ë‹¨ì„ ì…ë ¥í•˜ì„¸ìš”!");
  paragraphs.push(text.split("\n"));
  updateParagraphSelect();
  document.getElementById("paragraphInput").value = "";
}

function updateParagraphSelect() {
  const select = document.getElementById("paragraphSelect");
  select.innerHTML = "";
  paragraphs.forEach((p, idx) => {
    const opt = document.createElement("option");
    opt.value = idx;
    opt.textContent = `ë¬¸ë‹¨ ${idx+1}`;
    select.appendChild(opt);
  });
}

// ë¹ˆì¹¸ ì•”ê¸° ëª¨ë“œ
function startBlankMode() {
  const idx = document.getElementById("paragraphSelect").value;
  if (idx === "") return alert("ë¬¸ë‹¨ì„ ì„ íƒí•˜ì„¸ìš”");
  const lines = paragraphs[idx];
  let html = "<h3>ë¹ˆì¹¸ ì•”ê¸°</h3>";
  lines.forEach(line => {
    const words = line.split(" ");
    const quiz = words.map(w => Math.random() < 0.5 ? `<span class='blank'></span>` : w).join(" ");
    html += `<div class='sentence'>${quiz}</div>`;
  });
  document.getElementById("quizArea").innerHTML = html;
}

// ìˆœì„œ ì•”ê¸° ëª¨ë“œ
function startOrderMode() {
  const idx = document.getElementById("paragraphSelect").value;
  if (idx === "") return alert("ë¬¸ë‹¨ì„ ì„ íƒí•˜ì„¸ìš”");
  const lines = [...paragraphs[idx]];
  let shuffled = lines.map((v,i)=>({v,i}));
  shuffled.sort(()=>Math.random()-0.5);

  let html = "<h3>ìˆœì„œ ì•”ê¸°</h3>";
  shuffled.forEach((obj, idx) => {
    html += `<div>${idx+1}. ${obj.v}</div>`;
  });
  html += "<p>ğŸ‘‰ ìœ„ ë¬¸ì¥ì˜ ì˜¬ë°”ë¥¸ ìˆœì„œë¥¼ ì…ë ¥í•´ë³´ì„¸ìš” (ì˜ˆ: 2 1 3 ...)</p>";
  document.getElementById("quizArea").innerHTML = html;
}

// PWA ì„¤ì¹˜ ì¤€ë¹„
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').then(() => {
    console.log('Service Worker ë“±ë¡ ì„±ê³µ');
  });
}
</script>
</body>
</html>
