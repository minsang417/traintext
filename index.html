<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>문단 암기 프로그램 (PWA 웹 버전)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <style>
    body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
    textarea { width: 100%; height: 150px; }
    button { margin: 5px 0; padding: 8px 12px; }
    .blank { display: inline-block; border-bottom: 2px solid black; width: 60px; margin: 0 3px; text-align: center; }
    .sentence { margin: 5px 0; }
  </style>
</head>
<body>
  <h1>📖 문단 암기 프로그램</h1>

  <h2>1. 문단 등록</h2>
  <textarea id="paragraphInput" placeholder="여기에 문단을 입력하세요 (문장마다 줄바꿈)"></textarea>
  <button onclick="registerParagraph()">문단 등록</button>

  <h2>2. 등록된 문단 선택</h2>
  <select id="paragraphSelect"></select>

  <h2>3. 기능 선택</h2>
  <button onclick="startBlankMode()">빈칸 암기</button>
  <button onclick="startOrderMode()">순서 암기</button>

  <div id="quizArea"></div>

<script>
let paragraphs = [];

function registerParagraph() {
  const text = document.getElementById("paragraphInput").value.trim();
  if (!text) return alert("문단을 입력하세요!");
  paragraphs.push(text.split("\n"));
  updateParagraphSelect();
  document.getElementById("paragraphInput").value = "";
}

function updateParagraphSelect() {
  const select = document.getElementById("paragraphSelect");
  select.innerHTML = "";
  paragraphs.forEach((p, idx) => {
    const opt = document.createElement("option");
    opt.value = idx;
    opt.textContent = `문단 ${idx+1}`;
    select.appendChild(opt);
  });
}

// 빈칸 암기 모드
function startBlankMode() {
  const idx = document.getElementById("paragraphSelect").value;
  if (idx === "") return alert("문단을 선택하세요");
  const lines = paragraphs[idx];
  let html = "<h3>빈칸 암기</h3>";
  lines.forEach(line => {
    const words = line.split(" ");
    const quiz = words.map(w => Math.random() < 0.5 ? `<span class='blank'></span>` : w).join(" ");
    html += `<div class='sentence'>${quiz}</div>`;
  });
  document.getElementById("quizArea").innerHTML = html;
}

// 순서 암기 모드
function startOrderMode() {
  const idx = document.getElementById("paragraphSelect").value;
  if (idx === "") return alert("문단을 선택하세요");
  const lines = [...paragraphs[idx]];
  let shuffled = lines.map((v,i)=>({v,i}));
  shuffled.sort(()=>Math.random()-0.5);

  let html = "<h3>순서 암기</h3>";
  shuffled.forEach((obj, idx) => {
    html += `<div>${idx+1}. ${obj.v}</div>`;
  });
  html += "<p>👉 위 문장의 올바른 순서를 입력해보세요 (예: 2 1 3 ...)</p>";
  document.getElementById("quizArea").innerHTML = html;
}

// PWA 설치 준비
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('sw.js').then(() => {
    console.log('Service Worker 등록 성공');
  });
}
</script>
</body>
</html>
